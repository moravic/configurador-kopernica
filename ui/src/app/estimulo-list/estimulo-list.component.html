<br>
<form [formGroup]="form">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Estímulos</mat-card-title>
       <button mat-icon-button (click)="importExcel()" color="black" disabled="{{disabled}}">
         <mat-icon svgIcon="import-xlsx"></mat-icon>
      </button>
      <button mat-icon-button (click)="exportExcel()" color="black" disabled="{{disabled}}">
         <mat-icon svgIcon="export-xlsx"></mat-icon>
      </button>
      <button mat-icon-button (click)="addNew()" color="black" disabled="{{disabled}}">
         <mat-icon svgIcon="add-new"></mat-icon>
      </button>
      <button mat-icon-button (click)="deleteAll()" color="black" disabled="{{disabled}}">
         <mat-icon svgIcon="delete-bin"></mat-icon>
      </button>
    </mat-card-header>
    <mat-card-content>
      <mat-table [dataSource]="elistMatTableDataSource" formControlName="stimuli">
        <ng-container matColumnDef="stimulus">
          <mat-header-cell *matHeaderCellDef style="width: 400px">
            Introduzca el nombre de los estímulos que se guardarán en orden
          </mat-header-cell>
          <mat-cell *matCellDef="let stimulus; let rowIdx = index;" [formGroup]="stimulus">
            <mat-form-field style="width: 400px">
              <mat-label></mat-label>
               <input matInput formControlName="name" placeholder="Estimulo" required>
               <mat-error *ngIf="name?.invalid">
                <div *ngIf="name.errors && name.errors.required">La descripción del estímulo es obligatoria</div>
              </mat-error>
            </mat-form-field>
          </mat-cell>
        </ng-container>
        
        <!-- Delete Column -->
        <ng-container matColumnDef="deleteStimulus">
			<mat-header-cell *matHeaderCellDef> Borrado </mat-header-cell>
			<mat-cell *matCellDef="let stimulus; let rowIdx = index;" [formGroup]="stimulus">
	       		<button mat-icon-button color="primary" aria-label="" (click)="deleteStimulus(stimulus)">
	        		<mat-icon svgIcon="delete-bin"></mat-icon>
	      		</button>
    		</mat-cell>
 		</ng-container>
        
        <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
        <mat-row (click)="onRowChanged(row, getActualIndex(i))" (input)="onRowChanged(row, getActualIndex(i))" *matRowDef="let row; columns: displayedColumns; let i = index;">
        </mat-row>
      </mat-table>
    </mat-card-content>
    <!--mat-card-actions>
      <button mat-raised-button color="primary" [disabled]="testForm.invalid" (click)="save(testForm);">SAVE</button>
    </mat-card-actions-->
  </mat-card>
</form>